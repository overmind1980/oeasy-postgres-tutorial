---
show: step
version: 1.0
enable_checker: true
---

# åœ¨psqlä¸­ç¼–è¾‘å¹¶è¿è¡Œsqlè¯­å¥

## å›å¿†

- ä¸Šæ¬¡æˆ‘ä»¬ç¼–è¾‘äº†sqlæ–‡ä»¶
  - sqlæ–‡ä»¶æ˜¯çº¯æ–‡æœ¬æ–‡ä»¶
  - sqlæ‰¹é‡å¤„ç†sqlå‘½ä»¤

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658383948877)

- ç„¶åæˆ‘ä»¬æ‰§è¡Œäº†sqlæ–‡ä»¶
  - åœ¨postgresä¸­
	  - `\i /tmp/test.sql`
	  - æ‰§è¡Œsqlæ–‡ä»¶
- ä½†æ˜¯ç¼–è¾‘å’Œæ‰§è¡Œåˆ†åˆ«åœ¨ä¸¤ä¸ªæ¨¡å¼Â·
  - shell
  - psql
- åˆ‡æ¨¡å¼å¾ˆéº»çƒ¦
  - èƒ½å¦åœ¨ä¸€ä¸ªæ¨¡å¼ä¸­å°±è¿ç¼–è¾‘å¸¦æ‰§è¡Œ
  - ä¸€æ¡é¾™å…¨åšäº†å‘¢ï¼ŸğŸ¤”


### å…ˆæŸ¥å¸®åŠ©

- é¦–å…ˆè¿˜æ˜¯è¦ä»¥postgresçš„èº«ä»½
	- è¿è¡Œpsql
- ç„¶ååœ¨psqlä¸­ help

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671187613185)

- \?æŸ¥è¯¢psqlå‘½ä»¤
	- æœç´¢æ‰§è¡Œå¤–éƒ¨å‘½ä»¤çš„çš„æ–¹å¼

### æœç´¢
- æ‰§è¡Œçš„å•è¯æ˜¯execute
	- å¯ä»¥æœç´¢exæ‰¾åˆ°ç›¸å…³ä¿¡æ¯
- /ex åœ¨å¸®åŠ©æ–‡æ¡£ä¸­ æœç´¢ex
	- æ‰¾åˆ°çº¢æ¡†ä¸­çš„æ–¹å¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671246753457)

- å°è¯•åœ¨psqlä¸­è¿è¡Œå¤–éƒ¨å‘½ä»¤vim

### è¿è¡Œå¤–éƒ¨å‘½ä»¤

```
\! ls
\! pwd
\! whoami
\! vi /tmp/test.sql
```

- è¿è¡Œå‘½ä»¤

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20240604-1717465511476)

- æ˜ç¡®å½“å‰è¿è¡Œpsqlçš„ç”¨æˆ·æ˜¯postgres
- \\! vi /tmp/test.sqlè¿›è¡Œç¼–è¾‘

### ç¼–å†™ä»£ç 

```
DROP DATABASE 
	IF EXISTS oeasydb;

CREATE DATABASE 
	oeasydb;

\c oeasydb

CREATE TABLE login(
	username VARCHAR(20), 
	password VARCHAR(20)
);

INSERT INTO
	login(username,password)
VALUES
	('oeasy','123'),
	('o2z','456'),
	('o3z','789')
;
```

- ç¼–è¾‘å™¨çš„é…è‰²æ–¹æ¡ˆæ¯”è¾ƒåŸå§‹
	d- æœ‰æ²¡æœ‰
	- å¯ä»¥ ç›´æ¥ç¼–è¾‘æ–‡ä»¶çš„ å‘½ä»¤ å‘¢ï¼Ÿ

### ç¼–è¾‘å‘½ä»¤

- åœ¨psqlä¸­æ˜¯å¯ä»¥ç›´æ¥ç¼–è¾‘æ–‡ä»¶çš„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658390085992)

- æˆ‘ä»¬è¯•è¯•

### ç¼–è¾‘sqlæ–‡ä»¶

- \e /tmp/test.sql
	- eçš„æ„æ€æ˜¯ç¼–è¾‘
	- edit

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671192293947)

- æˆ‘ä»¬é€‰æ‹©1å·ç¼–è¾‘å™¨
	- vim

### ä¿å­˜é—®é¢˜

- æ‰“å¼€ä¹‹å
	- å‘ç°è¿™ä¸ªsqlæ–‡ä»¶ä¾ç„¶æ˜¯åªè¯»çš„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671192362373)

- æ€ä¹ˆè§£å†³è¿™ä¸ªæƒé™çš„é—®é¢˜å‘¢ï¼Ÿ

### æ‰€æœ‰è€…é—®é¢˜

- è¿›å…¥ psql ä½¿ç”¨çš„æ˜¯ postgresèº«ä»½
	- è€Œ /tmp/test.sql çš„æ‰€æœ‰è€…ä¸º shiyanlou
- å¯ä»¥å°† /tmp/test.sql çš„æ‰€æœ‰è€…
	- è®¾ç½®ä¸º postgres 
- æ³¨æ„è¿™æ¬¡æ‰€æœ‰æƒå˜åŒ–
	- postgres ä» shiyanlou æ‰‹é‡ŒæŠ¢å¾—
		- /tmp/test.sqlçš„æ‰€æœ‰æƒä¹‹å
	- shiyanlou å°±å¤±å»äº†
		- å¯¹ /tmp/test.sql çš„å†™æƒé™

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658390504342)

- ç„¶åå†å»
  - \e /tmp/test.sql

### å¯å†™

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671192598271)

- è¿™æ¬¡/tmp/test.sqlå°±ä¸æ˜¯åªè¯»çš„äº†

### å°è¯•å†™å…¥

- :w
  - ç¡®å®æ˜¯å¯ä»¥å†™å…¥æ–‡ä»¶çš„
- :q
  - é€€å‡ºvim
- \i /tmp/test.sql
  - æ‰§è¡Œtest.sqlè¯­å¥

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671192694661)

- æ‰§è¡ŒæˆåŠŸ

### å°è¯•å†æ¬¡è¿è¡Œ

- æ–¹å‘é”®<kbd>â†‘</kbd> 
	- æ‰¾åˆ°ä¸Šä¸€æ¡å‘½ä»¤
	- å°è¯•å†æ¬¡è¿è¡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671192788252)

- å‡ºç°äº†é”™è¯¯

### çº é”™

- é”™è¯¯åŸå› æ˜¯
	- åœ¨è¿æ¥ç€oeasydbæ•°æ®åº“çš„æ—¶å€™
	- å°è¯•ç€åˆ é™¤oeasydb
	- å°±åƒåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸­åˆ é™¤å½“å‰æ–‡ä»¶å¤¹
	- äººä¸èƒ½é æç€å¤´å‘è·³èµ·æ¥
- å°è¯•ä¿®æ”¹
	- \e /tmp/test.sql
	- åœ¨æœ€å¼€å§‹çš„æ—¶å€™æ·»åŠ ä¸€å¥

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658390916701)

- å…ˆä»oeasydbä¸­é€€åˆ°postgresä¸­
	- å†å»å°è¯•åˆ é™¤

### å°è¯•è¿è¡Œ

- è¿™æ¬¡å¯ä»¥é¡ºåˆ©æˆåŠŸäº†
	- éƒ½æ˜¯åœ¨psqlé‡Œé¢è¿›è¡Œçš„
		- \e è¿›è¡Œç¼–è¾‘
		- \i è¿›è¡Œè¿è¡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658391078970)

- ä¸è¿‡é…è‰²æ–¹æ¡ˆæœ‰ç‚¹é—®é¢˜
- æƒ³è¦ä½¿ç”¨
	- é»˜è®¤ç”¨æˆ·shiyanlouçš„vimé…ç½®

### å¤åˆ¶vimé…ç½®æ–‡ä»¶

- ä»/etc/passwdä¸­æ‰¾åˆ°ä¸¤ä¸ªç”¨æˆ·çš„å®¿ä¸»æ–‡ä»¶å¤¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671193032331)

- å°†vimé…ç½®æ–‡ä»¶.vimrc
	- ä»/home/shiyanlou
	- å¤åˆ¶åˆ°
	- /var/lib/postgresä¸­
- å†è¿è¡Œpsql

### è§‚å¯Ÿé»˜è®¤ç¼–è¾‘å™¨

- åœ¨psqlä¸­ç¼–è¾‘æ–‡ä»¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671193169738)

- é»˜è®¤ç¼–è¾‘å™¨å·²ç»æ›¿æ¢

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671193200275)

- å…ˆåˆ°è¿™é‡Œ
	- å»æ€»ç»“å§

### æ€»ç»“

- è¿™æ¬¡æƒ³è¦è§£å†³
	- åœ¨shellå’Œpsqlä¸­æ¥å›åå¤åˆ‡æ¢çš„é—®é¢˜
- å…¨éƒ½åœ¨psqlä¸­æ‰§è¡Œ
  - \e è¿›è¡Œç¼–è¾‘
  - \i è¿›è¡Œè¿è¡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658391401106)

- è¿™æ ·å°±å¯ä»¥ä¸ç”¨
	- å…ˆ\qé€€å›åˆ°shell
	- å†è¿›vimäº†ç¼–è¾‘sqläº†
- è¿˜æœ‰æ›´å¥½ç”¨çš„å·¥ä½œæµä¹ˆï¼Ÿ
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´
