---
show: step
version: 1.0
enable_checker: true
---

# æ•°æ®åº“çš„è¿˜åŸ

## å›å¿†

- ä¸Šæ¬¡å°è¯•å¤‡ä»½æ•°æ®åº“
	- ç”¨çš„å‘½ä»¤æ˜¯pg_dump

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658408469748)

- dumpçš„æ„æ€æ˜¯è½¬å‚¨
	- æŠŠæ•°æ®åº“è½¬å‚¨åˆ°ä¸€ä¸ªsqlæ–‡ä»¶ä¸­
- ç„¶åå°±å¯ä»¥è¿›è¡Œè¿˜åŸäº†
- æˆ‘ä»¬å…ˆçœ‹çœ‹è½¬å‚¨æ–‡ä»¶
- å…·ä½“æ€ä¹ˆè¿˜åŸå‘¢?ğŸ¤”

### æŸ¥è¯¢å¸®åŠ©

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658405932882)

- å¥½åƒå°±æ˜¯ä¸€å¥è¯
- æˆ‘ä»¬è¯•ç€æ‰§è¡Œä¸€ä¸‹

### ç›´æ¥æ‰§è¡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671194868275)

- å¥½åƒå°±æ˜¯æŠŠè¿™ä¸ªoeasydb.sqlæ‰§è¡Œäº†ä¸€é
- å…ˆå»çœ‹çœ‹oeasydb.sqlè½¬å‚¨æ–‡ä»¶åˆ°åº•åšäº†äº›ä»€ä¹ˆï¼Ÿ
- éš¾é“è¿™ä¸ªå¤‡ä»½æ–‡ä»¶é‡Œé¢æ²¡æœ‰CREATE DATABASE?

### æŸ¥çœ‹dumpè½¬å‚¨æ–‡ä»¶

- ç¡®å®æ²¡æœ‰å’ŒDATABASEç›¸å…³çš„è¯­å¥

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658407827250)

- ç¬¬ä¸€ä¸ªCREATEçš„å°±æ˜¯TABLE
- æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å»ºå¥½oeasydbè¿™ä¸ªåº“
- ä½†æ˜¯ç”±äºç›®å‰å·²ç»æœ‰äº†
	- oeasydbè¿™ä¸ªåº“
	- loginè¿™ä¸ªè¡¨
- å¯¼è‡´æ•´ä¸ªè¿˜åŸè¿‡ç¨‹
	- åªå‘loginè¡¨æ’å…¥äº†3è¡Œè®°å½•
- å°è¯•å…ˆæŠŠoeasydbè¿™ä¸ªåº“åˆ é™¤äº†

### æŸ¥è¯¢å¸®åŠ©

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671194991086)

- psql -c XXX
	- c çš„æ„æ€åº”è¯¥æ˜¯ command
	- å¯ä»¥æ‰§è¡Œä¸€æ¡sqlå‘½ä»¤

### åˆ é™¤

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671195100386)

- åˆ é™¤ç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671195128408)

- ç¡®å®å°†oeasydbåˆ é™¤äº†
- åˆ é™¤äº†æ˜¯ä¸ºäº†çœ‹çœ‹oeasydb.sqlèƒ½å¦å°†ä»–æ¢å¤

### æ¢å¤oeasydbä¸­çš„æ•°æ®è¡¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671195202043)

- å¤±è´¥ï¼ï¼ï¼
- ç”±äºoeasydb.sqlä¸­
	- æ²¡æœ‰CREATE DATABASEçš„è¯­å¥
	- å¯¼è‡´è¿˜åŸå¤±è´¥
- æ€ä¹ˆåŠå‘¢ï¼Ÿ


### å…ˆå»ºåº“å†è¿˜åŸ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671195355142)

- å¯ä»¥æŠŠoeasydbçš„åº“è¿˜åŸåˆ°ä¸€ä¸ªå«o2zdbçš„åå­—ä¸Šå—ï¼Ÿ

### è¿˜åŸåˆ°åˆ«çš„åå­—ä¸Š

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671195432512)

- å¯ä»¥è¿˜åŸ
- æœ¬è´¨ä¸Šå°±æ˜¯æ‰§è¡Œsqlè¯­å¥
- ä¸è¿‡æ€»ç”¨sudo -u postgres psql ...æ‰§è¡Œéå¸¸éº»çƒ¦
- æœ‰ç‚¹éº»çƒ¦èƒ½å¦ç›´æ¥ä½¿ç”¨postgresç™»å½•å‘¢ï¼Ÿ

### åˆ‡æ¢ç”¨æˆ·

- ç›´æ¥åˆ‡æ¢åˆ°postgres

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671196066794)

- shellä¸æ˜¯é»˜è®¤çš„zsh
- æƒ³è¦ä¿®æ”¹é»˜è®¤shell
- å¹¶é…ç½®zsh
- å…ˆexitå½“å‰ç™»å½•å›åˆ°shiyanlou

### é…ç½®postgresçš„zsh

- sudo chsh --shell /bin/zsh postgres
	- å°†postgresç”¨æˆ·é»˜è®¤shellä¿®æ”¹ä¸º/bin/zsh
- sudo cp /home/shiyanlou/.zshrc /var/lib/postgresql
	- å°†shiyanlouç”¨æˆ·çš„zshrcé…ç½®æ–‡ä»¶æ‹·è´åˆ°postgresçš„å®¿ä¸»æ–‡ä»¶å¤¹ä¸­

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671244598818)

- è¿™æ ·postgresç™»å½•æ˜¯å°±å¯ä»¥è‡ªåŠ¨ä½¿ç”¨é…ç½®æ­£å¸¸çš„zshäº†å—ï¼Ÿ

### ç™»å½•

- è¿™æ¬¡ç¡®å®postgresç™»å½•ç¡®å®æ­£å¸¸äº†

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671244616052)

- è¿™æ ·å°±å¯ä»¥ç”¨psqlç”¨æˆ·ç›´æ¥æ‰§è¡Œsqlæˆ–è€…å•æ¡å‘½ä»¤äº†å—ï¼Ÿ

### ç”¨postgresç”¨æˆ·æ‰§è¡Œsqlè¯­å¥

- ç¡®å®å¯ä»¥æ‰§è¡Œå•æ¡sqlè¯­å¥äº†

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221216-1671196362290)

- å¯ä»¥æ‰¹é‡æ‰§è¡Œsqlæ–‡ä»¶å—ï¼Ÿ

### ç”¨postgresç”¨æˆ·æ‰§è¡Œsqlæ–‡ä»¶

- æ‰§è¡Œsqlæ–‡ä»¶æˆåŠŸï¼ï¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671243524720)

- å¯ä»¥ç”¨postgresè¿™ä¸ªç”¨æˆ·è¿˜åŸæ•°æ®åº“å—ï¼Ÿ

### ç”¨postgresç”¨æˆ·è¿˜åŸæ•°æ®åº“

- è¿˜åŸæ•°æ®åº“çš„æœ¬è´¨å…¶å®å°±æ˜¯
	- è¿æ¥åˆ°æŒ‡å®šçš„æ•°æ®åº“
	- å¹¶ä¸”æ‰§è¡Œsqlæ–‡ä»¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671243681897)

- ç”±äºè¡¨åloginå·²ç»å­˜åœ¨
- æ‰€ä»¥CREATE TABLE å‡ºäº†é—®é¢˜
- ä½†æ˜¯è¿™ä¸ªæ•°æ®æ’å…¥loginè¡¨äº†å—ï¼Ÿ

### è§‚å¯Ÿ

- è¿æ¥æ•°æ®åº“å¹¶æŸ¥è¯¢sqlè¯­å¥

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671243808304)

- ç¡®å®æ’å…¥äº†
- æ‰€ä»¥ç°åœ¨åº“é‡Œé¢çš„æ•°æ®æ˜¯ä¸¤ä»½
- è¿™æœ‰ç‚¹é—®é¢˜
- é—®é¢˜å‡ºåœ¨å“ªå„¿å‘¢ï¼Ÿ
- å†è§‚å¯Ÿä¸€ä¸‹oeasydb.sql

### åˆ†æ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658405496217)

- å»ºè¡¨çš„è¯­å¥ä¼šå‘ç”ŸERROR
- åé¢æ’æ•°æ®çš„è¯­å¥æ‰§è¡Œäº†
- å†å»è¯•è¯•

### å†æ¢å¤

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671245112331)

- ç¡®å®å¦‚æˆ‘ä»¬æ‰€æ–™
- å‡ºç°äº†ERROR
- sqlæ‰¹å¤„ç†ä¸åœæ­¢
- ç»§ç»­åé¢æ’å…¥æ•°æ®
- å¯¼è‡´åˆå¤šäº†3è¡Œ
- èƒ½å¦è®©ä»–é‡åˆ°ERRORå°±åœä¸‹æ¥å‘¢ï¼Ÿ

### æŸ¥çœ‹å¸®åŠ©

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658412132234)

- æ‰§è¡Œçš„æ—¶å€™åŠ ä¸€ä¸ªå‚æ•°è¯•è¯•

### è¿è¡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671245294193)

- è¿™æ¬¡é‡åˆ°ERRORå°±ä¼šè‡ªåŠ¨åœæ­¢ä¸‹æ¥äº†
- åé¢æ’æ•°æ®çš„éƒ¨åˆ†å°±ä¸ä¼šæ‰§è¡Œäº†

### ç»§ç»­è§‚å¯Ÿå¸®åŠ©

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658412583927)

- å¯ä»¥åŠ ä¸Šå‚æ•°
- è®©æœ¬æ¬¡æ¢å¤è¿‡ç¨‹ä½œä¸ºä¸€ä¸ªäº‹åŠ¡(Transaction)
  - è¦ä¹ˆå…¨åš
  - è¦ä¹ˆä¸åš

### å°è¯•

- psql -1 oeasydb < oeasydb.sql

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671245682954)

- æœ€ç»ˆæ•°æ®å¦‚ä½•ï¼Ÿ

### æœ€ç»ˆæ•°æ®

- æ²¡æœ‰æ’å…¥æ–°çš„æ•°æ®

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671245802844)

- ç”±äºé‡åˆ°äº†ERROR
- è¿™ä¸ªäº‹åŠ¡å†³å®šéƒ½ä¸åš
- äºæ˜¯è¿›è¡Œäº†å›æ»š(ROLL BACK)
- å¸®åŠ©é‡Œé¢è¿˜æœ‰ä»€ä¹ˆäº¤ä»£çš„å‘¢ï¼Ÿ

### è¿œç¨‹å¤‡ä»½åŠ è¿˜åŸ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658412925623)

- è¿™ä¸ªç®¡é“çš„å‰é¢ 
	- æ˜¯ç”Ÿæˆè½¬å‚¨çš„sql
- ç®¡é“çš„åé¢
	- æ˜¯æ¥æ”¶sqlæ–‡ä»¶å¹¶æ‰§è¡Œ

- èƒ½å¦å¤‡ä»½è¿˜åŸå¤šä¸ªæ•°æ®åº“å‘¢ï¼Ÿ

### å¤šä¸ªæ•°æ®åº“

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658413521740)

- åº”è¯¥æ˜¯å¯ä»¥å¤‡ä»½è¿˜åŸå¤šä¸ªæ•°æ®åº“çš„
	- åŸºæœ¬å…ˆè¿™æ ·
- æˆ‘ä»¬æ€»ç»“å»!ğŸš¶

## æ€»ç»“

- è¿™ä¸€æ¬¡æˆ‘ä»¬è¿˜åŸäº†æ•°æ®åº“
	- æœ¬è´¨ä¸Šå°±æ˜¯é€šè¿‡psqlæ‰§è¡Œäº†ç›¸åº”çš„sqlæ–‡ä»¶
	- sqlæ–‡ä»¶æ˜¯å°†å½“å‰æ•°æ®åº“ä¼ å‚¨å¾—åˆ°çš„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658461343039)

- é€šè¿‡è¿™ç§æ–¹æ³•
	- æˆ‘ä»¬å°±å¯ä»¥å¤‡ä»½è¿˜åŸæ•°æ®åº“äº†
	- è¿™ç§è¿˜åŸå¯ä»¥æ— è§†æ•°æ®åº“çš„ç‰ˆæœ¬
- ä¸è¿‡å¤‡ä»½çš„è¯­å¥é‡Œé¢
	- å¥½åƒæ²¡æœ‰ç”¨åˆ°INSERTè¯­å¥
- é‚£ç©¶ç«Ÿæ˜¯æ€ä¹ˆæ’å…¥æ•°æ®çš„å‘¢ï¼ŸğŸ¤”
- æˆ‘ä»¬ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹
