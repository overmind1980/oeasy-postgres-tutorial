---
show: step
version: 1.0
enable_checker: true
---

#   时间日期类型_date_time_数据类型 
 

##  回忆

- 在日期时间函数中
	- 找到了 EXTRACT 
		- 可以解压出 年月日
	- EXTRACT 不仅 postgres 支持
		- oracle、mysql 都支持
		- 是sql 标准的一部分

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230901-1693573150061)

- 日期类型 也是 sql标准的一部分
	- 列 使用 这种类型
	- 就可以使用针对这种类型的 运算和函数
	- 相对 纯字符串 有很大进步
	- 也实现了1NF

- 1NF 还有什么 应用的场景吗？

### 器材租赁

- 关于器材租赁的数据

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693645084365)

### 期待转化

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693645175510)

- 这样保证每个数据都是
	- 原子值
	- atomic value
- 便于后续运算

### 原始数据

- 现在需要把这些数据放到一个表里面

```
设备,租金,价格,所属租赁公司,租赁公司位置,租赁公司电话
索尼小蜜蜂 Sony D11无线采访话筒小蜜蜂领夹麦克风录音,38,1天 50.00元， 2天 45.00元， 3天 40.00元， 之后续租 38.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
凡赛FarseeingFS-LED1000D影视摄影灯,80,满1天 ￥100.00元， 满2天 ￥90.00元， 满3天 ￥80.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
意美捷G30摄像机轻型摄影摄像专用三脚架,40,满1天 ￥50.00元， 满2天 ￥45.00元， 满3天 ￥40.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
Canon/佳能EF 100-400mm F4.5-5.6L 远摄变焦镜头大白兔,120,1天 150.00元， 2天 145.00元， 3天 143.33元， 之后续租 120.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
Canon/佳能EOS 5D4 专业全画幅旗舰级单反相机单机,150,1天 190.00元， 2天 180.00元， 3天 173.33元， 之后续租 150.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
650W 阿莱型透射式影视聚光灯微电影灯具舞台摄像灯摄影灯,40,满1天 ￥50.00元， 满2天 ￥45.00元， 满3天 ￥40.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
Canon佳能5D3全画幅旗舰5D Mark III单反相机单机,109,1天 150.00元， 2天 139.50元， 3天 125.00元， 之后续租 109.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
索尼／sony x280 高清摄像机拍摄套装ex280升级,139,1天 160.00元， 2天 152.00元， 3天 145.67元， 之后续租 139.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
智云CRANE 云鹤2单反稳定器手持云台三轴,50,1天 80.00元， 2天 77.50元， 3天 66.67元， 之后续租 50.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
SONY 索尼SAL 24-70mm F2.8 ZA SSM 蔡司变焦镜头,80,1天 99.00元， 2天 97.50元， 3天 93.33元， 之后续租 80.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
OSMO灵眸手持云台相机  gopro,69,1天 100.00元， 2天 90.00元， 3天 80.00元， 之后续租 69.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
Canon佳能红圈 二代 EF 24-70mm f2.8变焦镜头,80,1天 99.00元， 2天 95.00元， 3天 90.00元， 之后续租 80.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
凡赛FD-LED256S 双色温 led平板补光人像摄像灯三灯套装,170,1天 240.00元， 2天 230.00元， 3天 220.00元， 之后续租 170.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
凡赛 256s大功率led摄影灯 摄像灯外拍灯影视灯电影灯演播灯灯光,60,1天 100.00元， 2天 90.00元， 3天 80.00元， 之后续租 60.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
1000W 阿莱型透射式影视聚光灯微电影灯具舞台摄像灯摄影灯,80,满1天 ￥100.00元， 满2天 ￥90.00元， 满3天 ￥80.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
Canon佳能EF70-200mm F2.8 二代小白兔变焦镜头,80,1天 99.00元， 2天 94.00元， 3天 86.33元， 之后续租 80.00元,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399
18KP日光型（5600℃),2500,,先力租赁,北京电影学院南侧,18210959188
18K日光型（5600℃),2000,,先力租赁,北京电影学院南侧,18210959188
12KP日光型（5600℃),2000,,先力租赁,北京电影学院南侧,18210959188
12K日光型（5600℃),1500,,先力租赁,北京电影学院南侧,18210959188
6KP日光型（5600℃),1000,,先力租赁,北京电影学院南侧,18210959188
6K日光型（5600℃),800,,先力租赁,北京电影学院南侧,18210959188
4KP日光型（5600℃),600,,先力租赁,北京电影学院南侧,18210959188
4K日光型（5600℃),400,,先力租赁,北京电影学院南侧,18210959188
2.5KP日光型（5600℃),400,,先力租赁,北京电影学院南侧,18210959188
2.5K日光型（5600℃),200,,先力租赁,北京电影学院南侧,18210959188
1.2KP日光型（5600℃),200,,先力租赁,北京电影学院南侧,18210959188
1.2K日光型（5600℃),150,,先力租赁,北京电影学院南侧,18210959188
575W日光型（5600℃),100,,先力租赁,北京电影学院南侧,18210959188
200WP日光型（5600℃),200,,先力租赁,北京电影学院南侧,18210959188
400W日光型（5600℃),300,,先力租赁,北京电影学院南侧,18210959188
大KINO,200,,先力租赁,北京电影学院南侧,18210959188
小KINO,150,,先力租赁,北京电影学院南侧,18210959188
8排KINO,400,,先力租赁,北京电影学院南侧,18210959188
"12""LED",150,,先力租赁,北京电影学院南侧,18210959188
"10""LED",100,,先力租赁,北京电影学院南侧,18210959188
车拍灯,400,,先力租赁,北京电影学院南侧,18210959188
12*12一套,200,,先力租赁,北京电影学院南侧,18210959188
20*20一套,600,,先力租赁,北京电影学院南侧,18210959188
8*8一套,100,,先力租赁,北京电影学院南侧,18210959188
特图利,300,,先力租赁,北京电影学院南侧,18210959188
12K钨丝灯（3200℃）单价,800,,先力租赁,北京电影学院南侧,18210959188
12K头灯钨丝灯（3200℃）单价,600,,先力租赁,北京电影学院南侧,18210959188
9k头灯钨丝灯（3200℃）单价,500,,先力租赁,北京电影学院南侧,18210959188
5K钨丝灯（3200℃）单价,200,,先力租赁,北京电影学院南侧,18210959188
2K钨丝灯（3200℃）单价,100,,先力租赁,北京电影学院南侧,18210959188
1K钨丝灯（3200℃）单价,60,,先力租赁,北京电影学院南侧,18210959188
650W钨丝灯（3200℃）单价,50,,先力租赁,北京电影学院南侧,18210959188
300W钨丝灯（3200℃）单价,40,,先力租赁,北京电影学院南侧,18210959188
150W钨丝灯（3200℃）单价,40,,先力租赁,北京电影学院南侧,18210959188
2000W散光钨丝灯（3200℃）单价,50,,先力租赁,北京电影学院南侧,18210959188
800W散光钨丝灯（3200℃）单价,40,,先力租赁,北京电影学院南侧,18210959188
P64钨丝灯（3200℃）单价,40,,先力租赁,北京电影学院南侧,18210959188
2K闪电灯,100,,先力租赁,北京电影学院南侧,18210959188
5k发电机,200,,先力租赁,北京电影学院南侧,18210959188
6k发电机,300,,先力租赁,北京电影学院南侧,18210959188
12*12蓝布,100,,先力租赁,北京电影学院南侧,18210959188
12*12绿布,100,,先力租赁,北京电影学院南侧,18210959188
大蓝布,400,,先力租赁,北京电影学院南侧,18210959188
大绿布,400,,先力租赁,北京电影学院南侧,18210959188
佳能红圈16-35 ,100,,先力租赁,北京电影学院南侧,18210959188
佳能红圈24-70,100,,先力租赁,北京电影学院南侧,18210959188
佳能红圈70-200,100,,先力租赁,北京电影学院南侧,18210959188
佳能红圈100微距,100,,先力租赁,北京电影学院南侧,18210959188
镜头8-15鱼眼,200,,先力租赁,北京电影学院南侧,18210959188
镜头增倍镜,200,,先力租赁,北京电影学院南侧,18210959188
蔡司定焦20,50,,达达影视租赁,中戏东门外,13456332232
摄影小监视器,100,,达达影视租赁,中戏东门外,13456332232
导演大监视器21寸,200,,达达影视租赁,中戏东门外,13456332232
灯光师,1500,,达达影视租赁,中戏东门外,13456332232
轨道车（4直3弯）,100,,达达影视租赁,中戏东门外,13456332232
跟机员,200,,达达影视租赁,中戏东门外,13456332232
灯光助理 ,300,,达达影视租赁,中戏东门外,13456332232
摄影助理 ,500,,达达影视租赁,中戏东门外,13456332232
现场制片 ,1000,,达达影视租赁,中戏东门外,13456332232
便携LED灯,150,,达达影视租赁,中戏东门外,13456332232
小的LED,100,,达达影视租赁,中戏东门外,13456332232
车辆（金杯车） ,500,,达达影视租赁,中戏东门外,13456332232
车辆（依维柯）  ,800,,达达影视租赁,中戏东门外,13456332232
魔术腿灯架,50,,达达影视租赁,中戏东门外,13456332232
黑旗,50,,达达影视租赁,中戏东门外,13456332232
白旗,50,,达达影视租赁,中戏东门外,13456332232
反光板,50,,达达影视租赁,中戏东门外,13456332232
柔光灯箱,50,,达达影视租赁,中戏东门外,13456332232
对讲机,50,,达达影视租赁,中戏东门外,13456332232
```

- 首先把 他们放到一个csv文件中

### 数据整理

```
sudo apt update
sudo apt install libreoffice
```

- 安装之后
	- 用 calc 打开 device.csv

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693646402431)

### 移动数据

- 将BC两列
	- 移动到 最后

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693646621127)

- 再将 BC两列 删除

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693646689805)

### 分列工作

- 选中 `F列`
	- 进行分列

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693646745629)

- 使用中文大写逗号分列

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693647164771)

### 继续处理

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693647537956)

- 需要完成 批量替换

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693647616023)

### 替换之后

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693647817185)

- 需要将数据格式中的人民币标志去掉

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693647989576)

- 将数据类型 设置为浮点型
	- 点击 7.4 图表

### 补完数据

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693648647662)

- 将文件另存为 device2.csv

### 最终文件 

```
device,company,location,telephone,1day,2day,3day,4day
索尼小蜜蜂 Sony D11无线采访话筒小蜜蜂领夹麦克风录音,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,50.00,45.00,40.00,38.00
凡赛FarseeingFS-LED1000D影视摄影灯,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,100.00,90.00,80.00,80.00
意美捷G30摄像机轻型摄影摄像专用三脚架,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,50.00,45.00,40.00,40.00
Canon/佳能EF 100-400mm F4.5-5.6L 远摄变焦镜头大白兔,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,150.00,145.00,143.33,120.00
Canon/佳能EOS 5D4 专业全画幅旗舰级单反相机单机,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,190.00,180.00,173.33,150.00
650W 阿莱型透射式影视聚光灯微电影灯具舞台摄像灯摄影灯,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,50.00,45.00,40.00,40.00
Canon佳能5D3全画幅旗舰5D Mark III单反相机单机,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,150.00,139.50,125.00,109.00
索尼／sony x280 高清摄像机拍摄套装ex280升级,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,160.00,152.00,145.67,139.00
智云CRANE 云鹤2单反稳定器手持云台三轴,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,80.00,77.50,66.67,50.00
SONY 索尼SAL 24-70mm F2.8 ZA SSM 蔡司变焦镜头,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,99.00,97.50,93.33,80.00
OSMO灵眸手持云台相机  gopro,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,100.00,90.00,80.00,69.00
Canon佳能红圈 二代 EF 24-70mm f2.8变焦镜头,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,99.00,95.00,90.00,80.00
凡赛FD-LED256S 双色温 led平板补光人像摄像灯三灯套装,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,240.00,230.00,220.00,170.00
凡赛 256s大功率led摄影灯 摄像灯外拍灯影视灯电影灯演播灯灯光,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,100.00,90.00,80.00,60.00
1000W 阿莱型透射式影视聚光灯微电影灯具舞台摄像灯摄影灯,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,100.00,90.00,80.00,80.00
Canon佳能EF70-200mm F2.8 二代小白兔变焦镜头,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,99.00,94.00,86.33,80.00
18KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,2500,2500,2500,2500
18K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,2000,2000,2000,2000
12KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,2000,2000,2000,2000
12K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,1500,1500,1500,1500
6KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,1000,1000,1000,1000
6K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,800,800,800,800
4KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,600,600,600,600
4K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,400,400,400,400
2.5KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,400,400,400,400
2.5K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,200,200,200,200
1.2KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,200,200,200,200
1.2K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,150,150,150,150
575W日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,100,100,100,100
200WP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,200,200,200,200
400W日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,300,300,300,300
大KINO,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
小KINO,先力租赁,北京电影学院南侧,18210959188,150,150,150,150
8排KINO,先力租赁,北京电影学院南侧,18210959188,400,400,400,400
"12""LED",先力租赁,北京电影学院南侧,18210959188,150,150,150,150
"10""LED",先力租赁,北京电影学院南侧,18210959188,100,100,100,100
车拍灯,先力租赁,北京电影学院南侧,18210959188,400,400,400,400
12*12一套,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
20*20一套,先力租赁,北京电影学院南侧,18210959188,600,600,600,600
8*8一套,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
特图利,先力租赁,北京电影学院南侧,18210959188,300,300,300,300
12K钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,800,800,800,800
12K头灯钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,600,600,600,600
9k头灯钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,500,500,500,500
5K钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
2K钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
1K钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,60,60,60,60
650W钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,50,50,50,50
300W钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,40,40,40,40
150W钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,40,40,40,40
2000W散光钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,50,50,50,50
800W散光钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,40,40,40,40
P64钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,40,40,40,40
2K闪电灯,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
5k发电机,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
6k发电机,先力租赁,北京电影学院南侧,18210959188,300,300,300,300
12*12蓝布,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
12*12绿布,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
大蓝布,先力租赁,北京电影学院南侧,18210959188,400,400,400,400
大绿布,先力租赁,北京电影学院南侧,18210959188,400,400,400,400
佳能红圈16-35 ,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
佳能红圈24-70,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
佳能红圈70-200,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
佳能红圈100微距,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
镜头8-15鱼眼,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
镜头增倍镜,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
蔡司定焦20,达达影视租赁,中戏东门外,13456332232,50,50,50,50
摄影小监视器,达达影视租赁,中戏东门外,13456332232,100,100,100,100
导演大监视器21寸,达达影视租赁,中戏东门外,13456332232,200,200,200,200
灯光师,达达影视租赁,中戏东门外,13456332232,1500,1500,1500,1500
轨道车（4直3弯）,达达影视租赁,中戏东门外,13456332232,100,100,100,100
跟机员,达达影视租赁,中戏东门外,13456332232,200,200,200,200
灯光助理 ,达达影视租赁,中戏东门外,13456332232,300,300,300,300
摄影助理 ,达达影视租赁,中戏东门外,13456332232,500,500,500,500
现场制片 ,达达影视租赁,中戏东门外,13456332232,1000,1000,1000,1000
便携LED灯,达达影视租赁,中戏东门外,13456332232,150,150,150,150
小的LED,达达影视租赁,中戏东门外,13456332232,100,100,100,100
车辆（金杯车） ,达达影视租赁,中戏东门外,13456332232,500,500,500,500
车辆（依维柯）  ,达达影视租赁,中戏东门外,13456332232,800,800,800,800
魔术腿灯架,达达影视租赁,中戏东门外,13456332232,50,50,50,50
黑旗,达达影视租赁,中戏东门外,13456332232,50,50,50,50
白旗,达达影视租赁,中戏东门外,13456332232,50,50,50,50
反光板,达达影视租赁,中戏东门外,13456332232,50,50,50,50
柔光灯箱,达达影视租赁,中戏东门外,13456332232,50,50,50,50
对讲机,达达影视租赁,中戏东门外,13456332232,50,50,50,50
```

##  总结🤔

- 这次需要将数据规范为1NF

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693645175510)

- 目前得到了 能够导入到 数据库中的数据
- 最终应该 如何导入呢？🤔
- 下次再说？👋🏻
