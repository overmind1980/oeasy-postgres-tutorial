---
show: step
version: 1.0
enable_checker: true
---

# å¤‡ä»½è¿˜åŽŸã€å¯¼å…¥å¯¼å‡ºæ€»ç»“

### æ‰§è¡Œsqlå‘½ä»¤

- æˆ‘ä»¬åœ¨psqlä¸­æ‰§è¡Œsqlæ‰¹å¤„ç†å‘½ä»¤
	- \i ~/test.sql

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220417-1650201563773)

- ç„¶åŽç¼–è¾‘ä¸€ä¸ªåˆå§‹åŒ–æ•°æ®åº“çš„sqlæ–‡ä»¶
	- å°è¯•æ‰§è¡Œ
- é—®é¢˜æ˜¯æ€»è¦åœ¨shellå’Œpsqlä¸¤ä¸ªé‡Œé¢æ¥å›žåˆ‡æ¢

### ç¼–è¾‘sqlæ–‡ä»¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658390155550)

- \i å¯ä»¥æ‰§è¡Œsqlæ–‡ä»¶
- \e å¯ä»¥ç¼–è¾‘sqlæ–‡ä»¶
- \\! å¯ä»¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤
- ä½†è¿™è¿˜ä¸æ˜¯æœ€ä¼˜çš„å·¥ä½œæµ

### æœ€ä¼˜å·¥ä½œæµ

- å…ˆè¿›psql
	- ç„¶åŽç”¨viç¼–è¾‘sqlæ–‡ä»¶
	- åœ¨viä¸­ç”¨psqlæ‰§è¡Œå½“å‰çš„sqlæ–‡ä»¶
		- :!psql -f %

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658392161496)

- ç³»ç»Ÿæœ‰æ²¡æœ‰å¤‡ä»½è¿˜åŽŸæ•°æ®åº“çš„åŠžæ³•å‘¢ï¼Ÿ

### è½¬å‚¨dump

- dumpçš„æ„æ€æ˜¯å€¾å€’
	- è¿™é‡ŒæŒ‡çš„æ˜¯æŠŠæ•°æ®åº“çš„ç»“æž„å’Œå†…å®¹
	- å­˜å‚¨åˆ°sqlçš„æ–‡ä»¶ä¸­

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658460302663)

- å¯ä»¥æŠŠpg_dumpè½¬å‚¨è¾“å‡ºå¾—åˆ°çš„å†…å®¹
	- è¾“å‡ºé‡å®šå‘sqlè¯­å¥å½“ä¸­
	- æœ‰äº†è¿™ä¸ªå°±å¯ä»¥è¿˜åŽŸäº†ä¹ˆï¼Ÿ

### è¿˜åŽŸ

- ä¸Šæ¬¡æ˜¯å¤‡ä»½(backup)
- è¿™æ¬¡æ˜¯è¿˜åŽŸ(restore)
	- æŠŠsqlæ–‡ä»¶å½“åšè¾“å…¥ç»™åˆ°psqlçš„æŸä¸ªæ•°æ®åº“
	- ä¸€æ­¥æ­¥æ‰§è¡Œsqlæ–‡ä»¶å°±å¯ä»¥è¿˜åŽŸæ•°æ®åº“

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658409236126)

- sqlæ–‡ä»¶é‡Œé¢æåˆ°äº†ä¸€æ¡å‘½ä»¤
	- COPY
- æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ

### æ•°æ®å¯¼å‡º

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671249295441)

- COPY TO
  - æ•°æ®å¯ä»¥å¯¼å‡ºäº†
- é‚£ä¹ˆæ•°æ®å¯ä»¥å¯¼å…¥ä¹ˆï¼Ÿ

### æ•°æ®å¯¼å…¥

- ä¸Šæ¬¡æ•°æ®å¯¼å‡ºæ˜¯
  - COPY TO
- è¿™æ¬¡æ•°æ®å¯¼å…¥æ˜¯
  - COPY FROM

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671268359073)

- æˆ‘ä»¬å¯ä»¥ç”¨æ›´çµæ´»çš„æ–¹å¼æž„å»ºåˆå§‹åŒ–æ–‡ä»¶
- åŒ…æ‹¬
  - å»ºè¡¨
  - å¯¼å…¥å¯¼å‡º
- å„ä¸ªæ–‡ä»¶å„å¸å…¶èŒ
	- åˆ†å·¥åˆä½œ
- æˆ‘ä»¬æœ€åŽæ€»ç»“ä¸€ä¸‹

## æ€»ç»“

- æˆ‘ä»¬è¿™æ¬¡æ‰¾åˆ°äº†é€‚åˆæˆ‘ä»¬çš„å·¥ä½œæµç¨‹
  - è¿›psql
  - \e ç¼–è¾‘sqlæ–‡ä»¶
  - :!psql -f % æ‰§è¡Œå½“å‰sqlæ‰¹å¤„ç†å‘½ä»¤
- æ•°æ®åº“çš„å¤‡ä»½è¿˜åŽŸ
  - pg_dump oeasydb > oeasydb.sql å¤‡ä»½
  - psql oeasydb < oeasydb.sql è¿˜åŽŸ
- æ•°æ®å¯¼å…¥å¯¼å‡º
  - COPY TO æ˜¯å¯¼å‡º
  - COPY FROM æ˜¯å¯¼å…¥
- æˆ‘ä»¬è¿˜æ²¡æœ‰å»ºç«‹èµ·ä¸€ä¸ªæœ‰æ„ä¹‰çš„æ•°æ®åº“
- ä¸‹æ¬¡è¯•è¯•ï¼ŸðŸ‘‹ðŸ»