---
show: step
version: 1.0
enable_checker: true
---

# åºåˆ—sequence

### å›å¿†

- ä¸Šæ¬¡äº†è§£äº†serialçš„è¯æº

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685882881510)

- serial æ˜¯ä¸€ç§æ•°æ®ç±»å‹
- åº”è¯¥å¦‚ä½•ç†è§£è¿™ç§æ•°æ®ç±»å‹å‘¢ï¼ŸğŸ¤”

### æŸ¥çœ‹æ–‡æ¡£

- https://www.postgresql.org/docs/16/datatype-numeric.html#DATATYPE-SERIAL

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685885164353)

- SERIALç±»å‹ å¹¶ä¸æ˜¯çœŸå®çš„ç±»å‹
	- è€Œæ˜¯ä¸€ç§æ ‡è®°æ³•
		- ä¸ºçš„æ˜¯æ˜ç¡®äº§ç”Ÿä¸€ä¸ªè‡ªå¢çš„å”¯ä¸€æ ‡è®°

- å»ºç«‹ä¸€ä¸ªSERIALç±»å‹çš„å˜é‡
	- ç›¸å½“äºæ‰§è¡Œä¸‰å¥è¯

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685885411838)

- ç¬¬ä¸€å¥è¯å°±æ˜¯CREATE SEQUENCE
	- è¿™å¦‚ä½•ç†è§£å‘¢ï¼Ÿ

### æŸ¥è¯¢å¸®åŠ©

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685885423089)

- https://www.postgresql.org/docs/16/sql-createsequence.html

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685885439255)

- ç…§ç€ç¬¬ä¸€å¥è¯åŸæ ·æ‰§è¡Œä¸€ä¸‹ä¼šå¦‚ä½•ï¼Ÿ

```
CREATE SEQUENCE  my_seq AS integer;
```

### è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686054783921)

- è¿™ä¸ªåºåˆ—æœ‰ä»€ä¹ˆç»†èŠ‚å‘¢ï¼Ÿ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686054854845)

- æœ‰å¾ˆå¤šå±æ€§
	- èµ·å§‹å€¼
	- æœ€å°å€¼
	- æœ€å¤§å€¼
	- æ­¥é•¿
	- å¾ªç¯
	- ç¼“å­˜

### æ“ä½œåºåˆ—çš„å‡½æ•°

- https://www.postgresql.org/docs/16/functions-sequence.html

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686055517092)

- åºåˆ—æœ¬è´¨ä¸Šæ˜¯å•è¡Œçš„è¡¨æ ¼
	- ä¸€èˆ¬ç”¨æ¥äº§ç”Ÿå”¯ä¸€æ ‡è®°åˆ—çš„å€¼

- ä½¿ç”¨ä¸€äº›æ–¹æ³•
	- å¯ä»¥å¾—åˆ°åºåˆ—çš„å€¼
- åºåˆ—çš„æ“ä½œå‡½æ•°
	- nextval
	- setval
	- currval
	- lastval

### nextval

- nextval å°±æ˜¯ä¸‹ä¸€ä¸ªå€¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686056049364)

- æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šå°†åºåˆ—è¿™ä¸ªå•è¡Œè¡¨çš„è®°å½•æ›´æ–°

### å½“å‰å€¼

- currval

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686056124677)

- å½“å‰å€¼å‡½æ•°ä¸å‘åæ¨è¿›
	- åªæ˜¯å¾—åˆ°å½“å‰çš„ä¸€ä¸ªå€¼

### è®¾ç½®å€¼

- setval

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686056248272)

- å¯ä»¥è®¾ç½®åºåˆ—çš„å€¼

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686056370408)

### lastval

- è¿”å›æœ€è¿‘è¿”å›ä¸€æ¬¡çš„åºåˆ—å€¼
	- å¯ä»¥ä¸å¸¦åºåˆ—å

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686056459807)

- ä»¥ä¸Šå°±æ˜¯åºåˆ—çš„å››ä¸ªæ–¹æ³•
	- currval
	- nextval
	- setval
	- lastval

- å…¶ä¸­nextvalæœ€ä¸ºå¸¸è§

### åˆ—ä¸Šçš„åºåˆ—

- åœ¨heroesè¡¨ä¸­
	- idå­—æ®µç»‘å®šä¸€ä¸ªåºåˆ—

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686056641201)

- åœ¨itemsè¡¨ä¸­
	- idå­—æ®µç»‘å®šå¦ä¸€ä¸ªåºåˆ—

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686056723730)

- åˆ—å’Œå­—æ®µæ˜¯å¦‚ä½•ç»‘å®šçš„å‘¢ï¼Ÿ


### ç»‘å®šè¿‡ç¨‹

- SERIALå…³é”®å­—	
	- å½“æˆ‘ä»¬å£°æ˜åˆ—çš„æ•°æ®ç±»å‹ä¸ºSERIALæ—¶
	- åšäº†ä¸‰ä»¶äº‹
		1. å»ºç«‹åºåˆ—
		2. å°†åºåˆ—ä¸åˆ—ç»‘å®š
		3. å°†åºåˆ—çš„æ‰€æœ‰è€…è®¾ç½®ä¸ºåˆ—

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686056821384)

- æ¯æ¬¡éƒ½è¦æ‰¾åˆ°nextval
- å¦‚ä½•ç†è§£åºåˆ—å‘¢ï¼Ÿ

### åºåˆ—

- sequence è¿™ä¸ªå•è¯æ¥è‡ªäº*sekw-
	- æ„æ€æ˜¯è·Ÿç€çš„to follow
- è·Ÿç€ç¬¬ä¸€ä¸ªçš„æ˜¯ç¬¬äºŒä¸ª
	- second
	- æ—¶é—´æ˜¯ä¸€ç§’ç§’(second)è¿‡å»çš„
	- sub å¾€ä¸‹ 
		- éšåè€Œæ¥çš„ subsequent
	- con å…±åŒçš„
		- ä¸€æ­¥æ­¥æœ€ç»ˆçš„ç»“æœ consequence
- ç»“å±€,åæœ; ç»­é›†;ä½™æ³¢ sequel
- è·Ÿç€çš„è¿™ä¸€å †äºº
	- æ„æˆä¸€ä¸ªå›¢ä¼™ society
	- æ„æˆä¸€ä¸ªé—¨æ´¾ sect
	- å½¼æ­¤å…³è” associate
	- å½¼æ­¤ä¹‹é—´è¦ social
	- è¿™äº›äººå½¼æ­¤æ˜¯åŒç±»suit	
		- ç©¿çš„éƒ½æ˜¯é‚£å¥—è¡£æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230115-1673765152074)

- åºåˆ—æ—¢ç„¶å¯ä»¥CREATE
	- æ˜¯å¦å¯ä»¥
		- DROP
		- ALTERå‘¢ï¼Ÿ
- æ˜¯å¦å’ŒDATABASEã€TABLEä¸€æ ·
	- éƒ½æœ‰å¢åˆ æ”¹ä¸‰ç§æ“ä½œå‘¢ï¼Ÿ

### åˆ é™¤åºåˆ—

- https://www.postgresql.org/docs/16/sql-dropsequence.html

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686057531686)

- å…·ä½“åˆ é™¤

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686057547810)

- è¿™é‡Œç¡®å®å’ŒDATABASEã€TABLEä¸€æ ·
	- éƒ½å¯ä»¥
		- CREATE æ–°å»º
		- DROP åˆ é™¤
- SEQUENCE æ˜¯å¦ å¯ä»¥
	- é€šè¿‡ALTERè¿›è¡Œä¿®æ”¹å‘¢?

### ä¿®æ”¹åºåˆ—

- https://www.postgresql.org/docs/16/sql-altersequence.html

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686056917171)

- å…·ä½“ä¾‹å­

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686056957433)

- é‡å¯åºåˆ—
	- å¯ä»¥è¯•è¯•å—ï¼Ÿ

### é‡å¯åºåˆ—

- ç›®å‰æœ‰ä¸‰åæ­¦å°†

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686057168048)

- å°è¯•é‡å¯åºåˆ—

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686057132473)

- è²Œä¼¼é‡å¯åºåˆ—æˆåŠŸ
- å¦‚æœå†æ’ä¸€åæ­¦å°†ä¼šå¦‚ä½•å‘¢ï¼Ÿ

### æ’å…¥æ­¦å°†

- å‘heroesæ’å…¥æ­¦å°†æˆåŠŸäº†

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686057383673)

- ä½†æ˜¯å…³ç¾½å’Œèµµäº‘çš„idéƒ½æ˜¯2
	- è¿™æ˜¾ç„¶å’Œidçš„å®šä¹‰ä¸ç¬¦åˆ


## æ€»ç»“

- è¿™äº†è§£äº†åºåˆ—SEQUENCE
	- sequence å°±æ˜¯ä¸€ä¸ªæŒ¨ç€ä¸€ä¸ªçš„åºåˆ—
	- å°±åƒè¿‡å®Œä¸€ç§’(second)
		- å°±æ˜¯ä¸‹ä¸€ä¸ªsecond (ç¬¬äºŒä¸ªç§’)
- SEQUENCEå¯ä»¥æœ‰å¾ˆå¤šè‡ªå·±çš„å‚æ•°

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686057870514)

- SEQUENCEå’ŒDATABASEã€TABLEä¸€æ ·
	- éƒ½å¯ä»¥
		- CREATE æ–°å¢
		- ALTER ä¿®æ”¹
		- DROP åˆ é™¤
- ä½†æ˜¯ä¿®æ”¹åºåˆ—ä¹‹å
	- å¯èƒ½é€ æˆè¡¨ä¸­çš„ä¸€äº›é”™è¯¯

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20230606-1686057915646)

- æ¯”å¦‚å…³ç¾½èµµäº‘idç›¸åŒ
	- idæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ
	- å¯ä»¥ç›¸åŒå—ï¼Ÿ
- ä¸‹æ¬¡å†è¯´ï¼ŸğŸ‘‹ğŸ»