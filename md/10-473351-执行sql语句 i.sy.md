---
show: step
version: 1.0
enable_checker: true
---

# 执行sql命令

## 回忆

- 上次总结了整个学到的东西
	- 建库的法宝postgres
	- 数据库
	- 表
	- 数据
- 他们都可以进行增删改查的操作
	- 这样就可以建立起属于自己的数据库
	- 不过每次建立要打好多字很麻烦
	- 能否一下子就建立起一个数据呢？🤔

### 思路

- 没思路 看帮助
- 看帮助 本身就是思路

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220417-1650201563773)

- 可以通过
- \i '/tmp/test.sql' 执行具体的命令？
- 我们去试试
- 首先先新建一个sql文件

### 新建

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220417-1650201672683)

- 使用vi去编辑一个/tmp/test.sql文件
- vi 是编辑器
- /tmp/test.sql 是被编辑的文件
	- tmp 代表temporary 临时的
	- test 代表测试
	- sql 
		- structured query language
		- 我们那些增删改查的语句都是sql语句

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220417-1650201682354)

- 进入之后
- 注意左下角显示[新文件]
- 按<kbd>i</kbd>切换进入到插入模式

### 书写程序
![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220417-1650201682354)

- 按<kbd>i</kbd>左下角出现插入
- 然后插入新建库的命令

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220417-1650202373558)

- 输入完成后
- <kbd>esc</kbd>退回到正常模式
- 输入:w进行保存

### 保存程序

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220417-1650202441067)

- 保存之后有提示

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220417-1650202469247)

- 如果想要深入vim学习
	- 可以去这里
	- [oeasy教您玩转vim](https://www.lanqiao.cn/courses/2840)

### 尝试执行

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658382927122)

- 执行之后有成功提示
	- CREATE DATABASE
	- 并且确实可以查找到新建的库

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658382964917)

- 如果再执行一次test.sql会如何呢？

### 再次执行

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658383018863)

- 这也很合理
- 执行一次之后
- 想要再执行就会有问题
- 我们尝试把数据库初始化程序写得完整一点
	- 建库
	- 建表
	- 插数据
	- 全都一把完成

### 重写程序

- 按<kbd>i</kbd>左下角出现‘插入’
- 然后插入新建库的命令
- 输入完成后
- <kbd>esc</kbd>退回到正常模式
- 输入:w进行保存

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658383359963)

- 再开一个终端尝试执行

### 尝试执行

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658383589468)

- 执行成功
- 这样就是连建库到建表到插数据一条龙了🐲
- 但是两个窗口切来切去很麻烦
- 能否不进入psql就把整个一条龙给做了呢？


### 总结

- 这次我们编辑了sql文件
	- sql文件是纯文本文件
	- sql批量处理并执行sql命令
- 而且我们执行了sql文件	
	- 在postgres中可以执行sql文件
	- `\i /tmp/test.sql`
- 但是编辑和执行分别在两个状态
	- shell和psql
	- 切来切去很麻烦
	- 能否在一个状态中就连编辑带执行
	- 一条龙全做了呢？🤔 
- 下次再说 👋

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658383948877)
