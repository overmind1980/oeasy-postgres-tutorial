---
show: step
version: 1.0
enable_checker: true
---

# 数据导入

## 回忆

- 数据导出并不复杂
	- 用的是COPY命令

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671249295441)

- 确实可以将数据导出
- 但是如何反过来？
	- 再将数据导入呢？🤔

### 查看帮助

- \h COPY

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220723-1658538942921)

- 导入和导出 的区别
	- 一个是`FROM`
	- 另一个是`TO`
- 不要翻页自己先试试
	- 前提是库oeasydb和表login都存在

### 导入数据

- 先确定login.csv存在

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671268027946)

- 然后尝试导入

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671268108870)

- 直接报错了
	- 应该是要加上OPTION
- 怎么加呢？

### 查看帮助

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220723-1658539129992)

### 再次尝试

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671268207747)

- 貌似成功了
- 我们去看一下结果

### 结果

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671268240988)

- 实践验证
- 确实是可以的
- 可以把列名明确吗？

### 明确类名

- 先查帮助

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671268430210)

- 然后插入

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671268359073)

- 如果我把括号里面的列名次序对调会如何呢？

### 调换列名次序

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671268571198)

- 是按照COPY语句中列名的次序进行插入的
- 那么我如果想要建立自己的数据化初始化批处理sql文件
- 可以从csv文件中完成么？

### 构建初始化语句

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671268776306)

- 这样的初始化语句可以执行么？

### 执行

- 这样确实是可以初始化数据库的

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20221217-1671268881984)

- 可是这两种方式哪种好呢？
  1. 直接把待COPY的数据写到sql里
  2. 把待COPY的数据写到csv格式的文件里

### 分工

- 应该说各有各的好处
- 第一种的好处是
	- 一个文件解决所有问题
		- 转储(pg_dump)用的就是第一种
- 第二种的好处是
  - 多个文件分工明确
	- sql负责整体的流程
	- csv负责具体的某个表的数据
	- 但是文件多了
		- 出错概率也会提高

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220723-1658542153223)

- 第二种
	- 就像各个器官各司其职
    - sql文件中只有构建结构的流程
    - 更容易理解
  - 各个表的数据也都在各自的csv中
    - 方便做一些更细化操作
- 不过没有生物愿意把自己器官化
	- 正如没有人愿意把自己工具化一样
	- 都希望自己是最全面完整的
- 这次就先到这里
	- 去总结一下

## 总结

- 我们上次是导出数据
  - 用的的是 COPY TO
- 这次是导入数据
  - 用的是COPY FROM
- 可以把csv格式的文档
	- 导入到数据库的表当中
- 初始化的时候
	- 也可以导入csv文件中数据直接进行初始化
- 备份还原、导入导出这部分
	- 基本完成了
- 我们去总结一下
