---
show: step
version: 1.0
enable_checker: true
---

# 投影运算

### 回忆

- 上次研究了投影

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230303-1677811840916)

- 数据库中的投影指的是
	- 使用SELECT将表中的列
	- 投射出来

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230303-1677809682517)

- 但是没有去除重复的行
- 如何去重呢？🤔

### 观察环境

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230603-1685800568399)

- 目前数据都不相同
- 还需要先更新数据

### 准备环境

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230603-1685800682179)

- 更新之后
	- 刘备和张飞的智力值都为65
- 查询一下帮助

### 进行查询

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230603-1685800811755)

- 有个关键字为DISTINCT

### 使用关键字

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230603-1685800846019)

- 使用DISTINCT之后

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230603-1685800893548)

- 经过去重之后
	- 就剩下两条记录了
- 这种去重有什么意义呢？

### 建立新表

- 建立新表

```
CREATE TABLE items(
    id serial, 
    name VARCHAR(20),
    city VARCHAR(10),
    effects VARCHAR(30),
    value int
)
;
```

- 插入数据

```
INSERT INTO 
    items(name,city,effects,value)
VALUES
    ('短戟','北海','武力+2','10'),('司马法','北海','统率+7 军师','50'),('墨子','北海','统率+4 攻城','30'),('管子','北海','政治+8 耕作','45'),('尉缭子','长安','统率+5 军师','40'),('漆叶青粘散','长安','寿命延长','45'),('商君书','长安','政治+7 耕作','40'),('孙子兵法','长沙','统率+10 鬼谋','70'),('麻沸散','长沙','寿命延长','50'),('老君入仙符','长沙','寿命延长','25'),('手戟','长沙','武力+2','10'),('论语','陈留','智力+7 人脉','50'),('金马槊','成都','武力+2','10'),('梅花袖箭','成都','武力+2 一骑','20'),('屠命散','桂阳','寿命延长','25'),('吴钩','桂阳','武力+1','5'),('吴越春秋','会稽','政治+2 水练','35'),('栢弓','蓟','武力+1 远射','25'),('百辟刀','蓟','武力+3','15'),('五石散','蓟','寿命延长','40'),('孙膑兵法','建邺','统率+5 冷静','40'),('养由基之弓','江陵','武力+4 远射','40'),('山海经','江州','智力+1 神速','30'),('斩蛇之剑','洛阳','武力+10 豪杰','70'),('四月民令','洛阳','政治+2 耕作','20'),('韩非子','洛阳','政治+10 兵心','50'),('周书阴符','洛阳','政治+2 冷静','35'),('短戟','濮阳','武力+2','10'),('亭历犬血散','濮阳','寿命延长','45'),('吴子','汝南','统率+6 军师','45'),('檀弓','汝南','武力+1','10'),('庄子','汝南','智力+8 辫舌','50'),('六韬','天水','统率+8 冷静','60'),('李广之弓','天水','武力+4 远射','40'),('伤寒杂病论','宛城','寿命延长','35'),('双铁戟','宛城','武力+4','15'),('大宛马','西凉','确实撤退','40'),('凉州马','西凉','确实撤退','40'),('礼记','西凉','智力+5 名士','35'),('遁甲天书','西凉','智力+3 鬼谋','45'),('史记','小沛','政治+5','20'),('青囊书','小沛','寿命延长','45'),('牛灯','许昌','监视','15'),('九鼎神丹经','许昌','智力+2','15'),('魏公子兵法','邺城','统率+3 练兵','25'),('枣木槊','永安','武力+1','5');
```

### 然后查询数据

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230603-1685802497243)

- 查询结果

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230603-1685802523098)

- 物品的数量
	- 总共有46件
- 其中city是有重复的
	- 想要没有重复的city列表
	- 应该怎么办呢？

### 记录去重

- 城市数量
	- 有21座

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230603-1685802686062)

- 这样就得到了不重复的城市名字
- 除了城市之外
	- 可以看到物品按照价值分出多少档次吗？

### 价值档次

- 价值档次
	- 有12档

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685843760800)

### 宝物名称

- 宝物名称
	- 总共有45种名称
- 宝物记录数
	- 总共有46条 

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685844931391)

- 这说明有一种宝物名称
	- 出现了两次

### 宝物功能

- 宝物功能
	- 总共有32种

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685845029485)

- 如果我想要将
	- 宝物城市和功能都查出来
		- 应该怎么办呢？

### 宝物城市 和 功能

- 这是一个投影(project)操作

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685845595685)

- 运行结果
	- <kbd>G</kbd> 可以跳转到最后一行

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685845652250)

- 总共46行
- 这是没有去重的结果
	- 可以对两个字段的投影结果去重吗？

### 两个字段去重

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685845764012)

- 运行结果

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685845779773)

- 共有44条记录
	- 这说明什么？

### 所有列分析

- 44条去重记录说明
	- 有两个条记录
		- 城市和效果是重复的

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685845883766)

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230604-1685845892053)

- 分别是长沙和西凉
- 如何理解distinct这个词呢？

## 总结

- 我们这次了解了关键词
	- DISTINCT
	- 作用是去除重复
- 在SELECT的时候
	- 如果有记录是重复的
	- 可以通过 DISTINCT 关键字
	- 将重复的记录去掉

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230701-1688212518234)

- DISTINCT 这个词究竟是怎么来的呢？
- 下次再说？👋🏻