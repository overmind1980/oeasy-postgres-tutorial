---
show: step
version: 1.0
enable_checker: true
---

#   时间日期类型_date_time_数据类型 
 

##  回忆

- 上次需要将数据规范为1NF

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693645175510)

- 目前得到了 能够导入到 数据库中的数据
- 最终应该 如何导入呢？🤔

### 上次文件 

```
device,company,location,telephone,1day,2day,3day,4day
索尼小蜜蜂 Sony D11无线采访话筒小蜜蜂领夹麦克风录音,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,50.00,45.00,40.00,38.00
凡赛FarseeingFS-LED1000D影视摄影灯,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,100.00,90.00,80.00,80.00
意美捷G30摄像机轻型摄影摄像专用三脚架,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,50.00,45.00,40.00,40.00
Canon/佳能EF 100-400mm F4.5-5.6L 远摄变焦镜头大白兔,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,150.00,145.00,143.33,120.00
Canon/佳能EOS 5D4 专业全画幅旗舰级单反相机单机,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,190.00,180.00,173.33,150.00
650W 阿莱型透射式影视聚光灯微电影灯具舞台摄像灯摄影灯,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,50.00,45.00,40.00,40.00
Canon佳能5D3全画幅旗舰5D Mark III单反相机单机,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,150.00,139.50,125.00,109.00
索尼／sony x280 高清摄像机拍摄套装ex280升级,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,160.00,152.00,145.67,139.00
智云CRANE 云鹤2单反稳定器手持云台三轴,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,80.00,77.50,66.67,50.00
SONY 索尼SAL 24-70mm F2.8 ZA SSM 蔡司变焦镜头,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,99.00,97.50,93.33,80.00
OSMO灵眸手持云台相机  gopro,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,100.00,90.00,80.00,69.00
Canon佳能红圈 二代 EF 24-70mm f2.8变焦镜头,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,99.00,95.00,90.00,80.00
凡赛FD-LED256S 双色温 led平板补光人像摄像灯三灯套装,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,240.00,230.00,220.00,170.00
凡赛 256s大功率led摄影灯 摄像灯外拍灯影视灯电影灯演播灯灯光,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,100.00,90.00,80.00,60.00
1000W 阿莱型透射式影视聚光灯微电影灯具舞台摄像灯摄影灯,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,100.00,90.00,80.00,80.00
Canon佳能EF70-200mm F2.8 二代小白兔变焦镜头,北京众合影视器材租赁有限公司,四惠东传媒大学北侧,13891233399,99.00,94.00,86.33,80.00
18KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,2500,2500,2500,2500
18K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,2000,2000,2000,2000
12KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,2000,2000,2000,2000
12K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,1500,1500,1500,1500
6KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,1000,1000,1000,1000
6K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,800,800,800,800
4KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,600,600,600,600
4K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,400,400,400,400
2.5KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,400,400,400,400
2.5K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,200,200,200,200
1.2KP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,200,200,200,200
1.2K日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,150,150,150,150
575W日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,100,100,100,100
200WP日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,200,200,200,200
400W日光型（5600℃),先力租赁,北京电影学院南侧,18210959188,300,300,300,300
大KINO,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
小KINO,先力租赁,北京电影学院南侧,18210959188,150,150,150,150
8排KINO,先力租赁,北京电影学院南侧,18210959188,400,400,400,400
"12""LED",先力租赁,北京电影学院南侧,18210959188,150,150,150,150
"10""LED",先力租赁,北京电影学院南侧,18210959188,100,100,100,100
车拍灯,先力租赁,北京电影学院南侧,18210959188,400,400,400,400
12*12一套,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
20*20一套,先力租赁,北京电影学院南侧,18210959188,600,600,600,600
8*8一套,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
特图利,先力租赁,北京电影学院南侧,18210959188,300,300,300,300
12K钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,800,800,800,800
12K头灯钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,600,600,600,600
9k头灯钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,500,500,500,500
5K钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
2K钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
1K钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,60,60,60,60
650W钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,50,50,50,50
300W钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,40,40,40,40
150W钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,40,40,40,40
2000W散光钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,50,50,50,50
800W散光钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,40,40,40,40
P64钨丝灯（3200℃）单价,先力租赁,北京电影学院南侧,18210959188,40,40,40,40
2K闪电灯,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
5k发电机,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
6k发电机,先力租赁,北京电影学院南侧,18210959188,300,300,300,300
12*12蓝布,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
12*12绿布,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
大蓝布,先力租赁,北京电影学院南侧,18210959188,400,400,400,400
大绿布,先力租赁,北京电影学院南侧,18210959188,400,400,400,400
佳能红圈16-35 ,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
佳能红圈24-70,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
佳能红圈70-200,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
佳能红圈100微距,先力租赁,北京电影学院南侧,18210959188,100,100,100,100
镜头8-15鱼眼,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
镜头增倍镜,先力租赁,北京电影学院南侧,18210959188,200,200,200,200
蔡司定焦20,达达影视租赁,中戏东门外,13456332232,50,50,50,50
摄影小监视器,达达影视租赁,中戏东门外,13456332232,100,100,100,100
导演大监视器21寸,达达影视租赁,中戏东门外,13456332232,200,200,200,200
灯光师,达达影视租赁,中戏东门外,13456332232,1500,1500,1500,1500
轨道车（4直3弯）,达达影视租赁,中戏东门外,13456332232,100,100,100,100
跟机员,达达影视租赁,中戏东门外,13456332232,200,200,200,200
灯光助理 ,达达影视租赁,中戏东门外,13456332232,300,300,300,300
摄影助理 ,达达影视租赁,中戏东门外,13456332232,500,500,500,500
现场制片 ,达达影视租赁,中戏东门外,13456332232,1000,1000,1000,1000
便携LED灯,达达影视租赁,中戏东门外,13456332232,150,150,150,150
小的LED,达达影视租赁,中戏东门外,13456332232,100,100,100,100
车辆（金杯车） ,达达影视租赁,中戏东门外,13456332232,500,500,500,500
车辆（依维柯）  ,达达影视租赁,中戏东门外,13456332232,800,800,800,800
魔术腿灯架,达达影视租赁,中戏东门外,13456332232,50,50,50,50
黑旗,达达影视租赁,中戏东门外,13456332232,50,50,50,50
白旗,达达影视租赁,中戏东门外,13456332232,50,50,50,50
反光板,达达影视租赁,中戏东门外,13456332232,50,50,50,50
柔光灯箱,达达影视租赁,中戏东门外,13456332232,50,50,50,50
对讲机,达达影视租赁,中戏东门外,13456332232,50,50,50,50
```

### 建表

```
CREATE DATABASE 
	film_studio
;

\c film_studio

CREATE TABLE device_rent(
    id SERIAL,
    device VARCHAR(40),
    company VARCHAR(40),
    location VARCHAR(40),
    telephone VARCHAR(40),
    1day NUMERIC,
    2day NUMERIC,
    3day NUMERIC,
    4day NUMERIC
)
;
```

- 结果

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693650092681)

- 1day 不能作为 标识符
	- 修改为day1

### 修改列名
```
CREATE DATABASE 
	film_studio
;

\c film_studio

CREATE TABLE device_rent(
    id SERIAL,
    device VARCHAR(40),
    company VARCHAR(40),
    location VARCHAR(40),
    telephone VARCHAR(40),
    day1 NUMERIC,
    day2 NUMERIC,
    day3 NUMERIC,
    day4 NUMERIC
)
;
```

- 建表成功

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693650187426)

### 处理数据标题

- 修改列表标题

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693650257990)

### 导入数据

```
\c film_studio

COPY 
	device_rent
FROM
	'/home/shiyanlou/device2.csv'
WITH
	CSV HEADER
;
```

- 导入失败

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693652817146)

### 指定列导入

```
\c film_studio

COPY 
	device_rent(
		device,
		company,
		location,
		telephone,
		day1,
		day2,
		day3,
		day4
	)
FROM
	'/home/shiyanlou/device2.csv'
WITH
	CSV HEADER
;
```

- 导入成功

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693652826917)

### 查询结果

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693652863532)

- 如果想查询 5D4 三天的租金
	- 应该如何呢？

### 查询

```
\c film_studio

SELECT 
	device,
	location,
	telephone,
	day3 * 3 AS rent
FROM
	device_rent
WHERE
	device LIKE '%5D4%'
ORDER By
	day3
;
```

- 结果

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693653678055)

##  总结🤔

- 这次成功将数据导入进了数据库
	- 当csv数据文件 中没有id字段的时候
	- 可以指定列进行导入
	- 会自动补全
- 如果查询 使用的是
	- 小写的5d4

```
\c film_studio

SELECT 
	device,
	location,
	telephone,
	day3 * 3 AS rent
FROM
	device_rent
WHERE
	device LIKE '%5d4%'
ORDER By
	day3
;
```

- 搜索不到结果

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230902-1693654009126)

- 这应该怎么办呢？
- 下次再说？👋🏻
