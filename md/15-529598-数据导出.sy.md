---
show: step
version: 1.0
enable_checker: true
---

# 总结

## 回忆

- 上次我们还原了数据库
- 本质上就是通过psql执行了相应的sql语句
- sql语句是将当前数据库传储得到的
- 然后我们就可以备份还原数据库了 

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658461343039)

- 不过备份的语句里面好像没有用到INSERT语句
- 那究竟是怎么插入数据的呢？🤔

### 分析数据

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469009484)

- 输出应该用的是COPY这条命令
- 我们可以具体试试么？

### 当前状态

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469229709)

- 当前数据库中有三条记录

### 插入数据

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469258920)

- 执行COPY命令
	- 列之间的分割符是<kbd>Tab</kdb>
	- 行之间的分隔符是<kbd>回车</kdb>
	- 结束输入的分隔符是`\.`
- 这样真的可以插入数据么？

### 检查插入结果

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469369876)

- 原来三条记录
- 现在四条
- 证明插入成功😄
- 这个COPY命令怎么理解呢？

### 查看帮助

- \h COPY

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469151754)

- 根据红色部分
- 写一条语句来导出login表中的数据

### 运行

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469522231)

- 貌似失败了
- 原因是没有目标文件data
- 这个语句也不会自动新建
- 怎么办？😰

### 先建文件

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469623286)

- 建好文件之后
- 给任何人读写权限
- 然后再回psql运行COPY

### COPY

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469703101)

- 执行成功了么？

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469724712)

- 好像确实是可以备份数据的
- 不过这个数据没有标题行
- 可以加上标题行么？

### 分析

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469159000)

- 可以再红色词语的基础上
- 添加上绿色的词语
- 不要翻页
- 尝试写下表头

### 运行

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469983473)

- 报错了
- 怎么办？

### 搜索报错信息

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220722-1658469167753)

- 根据这个
- 修改一下代码

### 修改代码

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220723-1658535972533)

- 运行结果呢？

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220723-1658535985906)

- CSV有个好处
- 什么好处呢？

### 电子表格

- 就是可以用电子表格软件打开了

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220723-1658536744715)

- 前提是安装电子表格软件
	- sudo apt install libreoffice

- 什么是csv呢？

### csv

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220723-1658538191779)

- 那么csv、电子表格、数据库是什么关系呢？

### 数据存储

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220723-1658538521713)

- 三者都是数据存储的方式
- 越往上
	- 文件越小
	- 格式结构越简单
- 越往下
	- 文件越大
	- 格式结构越复杂
- 数据导出就这样了
- 我们去总结一下吧

### 总结

- 数据导出并不复杂
- 用的是COPY命令

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220723-1658535972533)

- 确实可以将数据导出
- 但是如何反过来
- 再将数据导入呢？🤔
- 我们下次再说！👋🏻